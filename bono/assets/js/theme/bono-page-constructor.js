jQuery(function(n){var t,s,a=".customize-control-bono-page-constructor";function c(e){var e=e.parents(a),t=e.find(".bono-customize-pc-items"),o=e.find(".bono-customize-pc-field"),i=[];setTimeout(function(){t.find(".bono-customize-pc-item").each(function(){var e=n(this),o={};e.find("input, textarea, select").each(function(){var e=n(this),t=e.val();"checkbox"===e.attr("type")&&(t=e.is(":checked")),o[e.attr("name")]=t}),i.push(o)}),o.val(JSON.stringify(i)).trigger("change")},50)}function e(e){e.slideToggle(150)}function m(e){var t=e.closest(".js-bono-customize-pc-slider-item").find(".js-bono-customize-pc-slide-item-id"),o=e.closest(".js-bono-customize-pc-slider-item").find(".js-bono-customize-pc-slide-item-media");switch(e.val()){case"post":case"product":case"category":t.show(),o.hide();break;default:t.hide(),o.show()}}n(".bono-customize-pc-items").sortable({handle:".bono-customize-pc-item-header",axis:"y",update:function(e,t){c(n(this).find("input:first"))}}),n(document).on("change",".bono-customize-pc-item input, .bono-customize-pc-item select, .bono-customize-pc-item textarea",function(){c(n(this))}),n(document).on("keyup",".bono-customize-pc-item input, .bono-customize-pc-item textarea",function(){var e=n(this);clearTimeout(t),t=setTimeout(function(){c(e)},500)}),n(document).on("keyup",".bono-customize-pc-item input[name=section_header_text]",function(){var e=n(this);e.parents(".bono-customize-pc-item").find(".bono-customize-pc-item-header em").text(e.val())}),n(document).on("click",".bono-customize-pc-preset",function(){var e=n(this),t=e.parent();t.find(".bono-customize-pc-preset").removeClass("active"),e.addClass("active"),t.find("input[name=preset]").val(e.data("preset-name")).change()}),n(document).on("click",".bono-customize-pc-item-header",function(){n(this).parent().find(".bono-customize-pc-item-body").slideToggle()}),n(".js-bono-customize-pc-add").on("click",function(){var e=n(this),t=e.parents(a),o=t.find(".bono-customize-pc-items"),e=e.data("type"),e=t.find(".bono-customize-pc-placeholders .bono-customize-pc-item[data-type="+e+"]").clone();o.append(e),c(o.find("input:first"))}),n(document).on("click",".js-bono-customize-pc-delete",function(){var e=n(this),t=e.parents(a).find(".bono-customize-pc-items");e.parents(".bono-customize-pc-item").remove(),c(t)}),n(document).on("click",".bono-customize-pc-post-card-settings-open",function(){n(this).parents(".bono-customize-pc-item").find(".bono-customize-pc-post-card-settings").slideToggle()}),(s=n)(a).find(".bono-customize-pc-items .js-bono-customize-pc-slider-items").each(function(){var o,n,c=s(this),e=c.data("items");Object.keys(e).length&&(o=0,n=s(this).parents(a),s.each(e,function(i,t){var e=n.find(".bono-customize-pc-placeholders .js-bono-customize-pc-slider-item").clone();e.find("input, textarea, select").each(function(){var e,o=s(this);o.attr("name")&&(o.attr("name",o.attr("name").replace("{{n}}",i)),s.each(t,function(e,t){e="slide_items["+i+"]["+e+"]";o.attr("name")===e&&o.val(t)})),o.hasClass("js-bono-customize-pc-slide-item-type")&&m(o),o.hasClass("js-bono-customize-pc-slide-item-header")&&(e="Slide",""!==o.val()&&(e=o.val()),o.parents(".js-bono-customize-pc-slider-item").find(".js-bono-customize-pc-item--slide-header strong").text(e))}),o=Math.max(o,i),c.append(e),c.data("item_number",o)}))}),s(document).on("click",".js-bono-customize-pc-add-slide-item",function(){var e=s(this),t=e.parents(a),e=e.parents(".bono-customize-pc-item--slider").find(".js-bono-customize-pc-slider-items"),o=parseInt(e.data("item_number")||0);o++;t=t.find(".bono-customize-pc-placeholders .js-bono-customize-pc-slider-item").clone();t.find("input, textarea, select").each(function(){var e=s(this);e.attr("name")&&e.attr("name",e.attr("name").replace("{{n}}",o))}),t.find(".js-bono-customize-pc-item--slide-content").show(),e.append(t),e.data("item_number",o),c(e.find("input:first"))}),s(document).on("click",".js-bono-customize-pc-toggle-slide-item",function(){e(s(this).closest(".js-bono-customize-pc-item--slide-content"))}),s(document).on("click",".js-bono-customize-pc-item--slide-header",function(){e(s(this).closest(".js-bono-customize-pc-slider-item").find(".js-bono-customize-pc-item--slide-content"))}),s(document).on("click",".js-bono-customize-pc-delete-slide-item",function(){var e=s(this),t=e.parents(a).find(".bono-customize-pc-items");e.closest(".js-bono-customize-pc-slider-item").remove(),c(t)}),s(document).on("change",".js-bono-customize-pc-slide-item-type",function(){m(s(this))}),s(document).on("click",".js-bono-customize-pc-slide-item-media-browse",function(){var t=s(this),o=t.parents(a).find(".bono-customize-pc-items"),i=wp.media.frames.file_frame=wp.media({title:t.data("uploader_title"),button:{text:t.data("uploader_button_text")},multiple:!1});i.on("select",function(){var e=i.state().get("selection").first().toJSON();t.parent().find('input[type="text"]').val(e.url),c(o)}),i.open()}),s(".bono-customize-pc-slider-items").sortable({axis:"y",update:function(e,t){c(s(this).find("input:first"))}}),s(document).on("keyup",".js-bono-customize-pc-slide-item-header",function(){var e=s(this),t="Slide";""!==e.val()&&(t=e.val()),e.parents(".js-bono-customize-pc-slider-item").find(".js-bono-customize-pc-item--slide-header strong").text(t)})});